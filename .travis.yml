language: node_js
sudo: required
node_js: 
#  - stable
# - 12.16.1
  - 12.22.0

#cache:
#  directories:
#    - node_modules

branches:
  only:
    - source

# S: Build Lifecycle
before_install:
#  - npm install -g hexo-cli
  - npm install hexo-cli -g

install:
  - npm install
  # 部署到github
  - npm install hexo-deployer-git --save
  # 博文加密
  - npm install hexo-blog-encrypt --save
  # 置顶
  - npm install hexo-generator-index-pin-top --save
  # 内容折叠
  - npm install hexo-sliding-spoiler --save
  # 隐藏文章 https://github.com/printempw/hexo-hide-posts
  - npm install hexo-hide-posts --save
  # 上传图片到网页
  # - npm install hexo-asset-image --save
  # 本地搜索
  # - npm install hexo-generator-search --save
  # rss
  # - npm install --save hexo-generator-feed

script:
  - hexo clean
  - hexo generate

after_script:
  - git config user.name "KaizynX"
  - git config user.email "2291443901@qq.com"
  - sed -i "s/gh_token/${GH_TOKEN}/g" ./_config.yml
  - hexo deploy
# End: Build LifeCycle
#
#after_script:
# - cd ./public
# - git init
# - git config user.name "KaizynX"
# - git config user.email "2291443901@qq.com"
# - git add .
# - git commit -m "Update Blog"
# - git push --force --quiet "https://${GITHUB_TOKEN}@${GH_REF}" master:master
# E: Build LifeCycle

#env:
# global:
#  - GH_REF: github.com:KaizynX/KaizynX.github.io.git

